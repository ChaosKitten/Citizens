<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Citizensclient: Citizens::SFMLNetwork Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Citizensclient</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><b>Citizens</b>      </li>
      <li class="navelem"><a class="el" href="classCitizens_1_1SFMLNetwork.html">SFMLNetwork</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">Citizens::SFMLNetwork Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="Citizens::SFMLNetwork" --><!-- doxytag: inherits="Citizens::Network" --><div class="dynheader">
Inheritance diagram for Citizens::SFMLNetwork:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classCitizens_1_1SFMLNetwork.png" usemap="#Citizens::SFMLNetwork_map" alt=""/>
  <map id="Citizens::SFMLNetwork_map" name="Citizens::SFMLNetwork_map">
<area href="classCitizens_1_1Network.html" alt="Citizens::Network" shape="rect" coords="0,0,142,24"/>
</map>
 </div></div>

<p><a href="classCitizens_1_1SFMLNetwork-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCitizens_1_1SFMLNetwork.html#abb5cd462b141d3e6f042b94bd4298340">SFMLNetwork</a> (const <a class="el" href="classCitizens_1_1Protocol.html">Protocol</a> &amp;p)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">constructs an <a class="el" href="classCitizens_1_1SFMLNetwork.html">SFMLNetwork</a> object  <a href="#abb5cd462b141d3e6f042b94bd4298340"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCitizens_1_1SFMLNetwork.html#a52eec431a3b4609d2888bebcdb5d9c72">~SFMLNetwork</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">deletes the local 'socket' representation  <a href="#a52eec431a3b4609d2888bebcdb5d9c72"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCitizens_1_1SFMLNetwork.html#a58f8450d02f9ab1521154a20fa10ba23">connect</a> (const std::string &amp;ip)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">abstraction for establishing connection  <a href="#a58f8450d02f9ab1521154a20fa10ba23"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCitizens_1_1SFMLNetwork.html#af3684158823c3e77eb5893f83359dc61">send</a> (NetworkCommand c, char payload_length, const std::string &amp;payload)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">abstraction for sending a packet across the network  <a href="#af3684158823c3e77eb5893f83359dc61"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCitizens_1_1SFMLNetwork.html#a9ca766cae4efc1fccf5cd7e284fdcecc">receive</a> (<a class="el" href="structCitizens_1_1Packet.html">Packet</a> &amp;packet)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">fetch a packet from the network (a lot more complex than that)  <a href="#a9ca766cae4efc1fccf5cd7e284fdcecc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCitizens_1_1SFMLNetwork.html#a5a8d34814bdbe0517090b95dc8b59eab">login</a> (const std::string &amp;username, const std::string &amp;password)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is in charge of a lot, so I'm going to do my best to document it but forgive me if I don't catch everything.  <a href="#a5a8d34814bdbe0517090b95dc8b59eab"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCitizens_1_1SFMLNetwork.html#a8bc325d44d10fb5a8b43ab35095ea020">get_error</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">get a string representation of the error status of the network  <a href="#a8bc325d44d10fb5a8b43ab35095ea020"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCitizens_1_1SFMLNetwork.html#a3d94f769e00195248ca6ce2f81c5a745">is_disconnected</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">returns whether the network has been disconnected  <a href="#a3d94f769e00195248ca6ce2f81c5a745"></a><br/></td></tr>
</table>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="abb5cd462b141d3e6f042b94bd4298340"></a><!-- doxytag: member="Citizens::SFMLNetwork::SFMLNetwork" ref="abb5cd462b141d3e6f042b94bd4298340" args="(const Protocol &amp;p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SFMLNetwork::SFMLNetwork </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCitizens_1_1Protocol.html">Protocol</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>constructs an <a class="el" href="classCitizens_1_1SFMLNetwork.html">SFMLNetwork</a> object </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>a <a class="el" href="classCitizens_1_1Protocol.html" title="Protocol class containing.">Protocol</a> reference </td></tr>
  </table>
  </dd>
</dl>
<dl class="note"><dt><b>Note:</b></dt><dd>in future the <a class="el" href="classCitizens_1_1Protocol.html" title="Protocol class containing.">Protocol</a> class may be made 100% static and therefore references to it will be somewhat meaningless and wasteful, this is one area for clean-up if that ever becomes the case </dd></dl>

</div>
</div>
<a class="anchor" id="a52eec431a3b4609d2888bebcdb5d9c72"></a><!-- doxytag: member="Citizens::SFMLNetwork::~SFMLNetwork" ref="a52eec431a3b4609d2888bebcdb5d9c72" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SFMLNetwork::~SFMLNetwork </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>deletes the local 'socket' representation </p>
<dl class="note"><dt><b>Note:</b></dt><dd>in future versions this destructor may be deleted as the socket should not be a pointer, it was only changed to a pointer while I was experimenting with something </dd></dl>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a58f8450d02f9ab1521154a20fa10ba23"></a><!-- doxytag: member="Citizens::SFMLNetwork::connect" ref="a58f8450d02f9ab1521154a20fa10ba23" args="(const std::string &amp;ip)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SFMLNetwork::connect </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ip</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>abstraction for establishing connection </p>
<p>little more than a wrapper around sf::TcpSocket::connect() in future versions it may send a command to the server to verify things like version matching </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>the ip of the server to attempt connection with </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a boolean representing whether or not a connection was established. </dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>modifies the 'disconnected' status of the network </dd></dl>

<p>Implements <a class="el" href="classCitizens_1_1Network.html">Citizens::Network</a>.</p>

</div>
</div>
<a class="anchor" id="a8bc325d44d10fb5a8b43ab35095ea020"></a><!-- doxytag: member="Citizens::SFMLNetwork::get_error" ref="a8bc325d44d10fb5a8b43ab35095ea020" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string SFMLNetwork::get_error </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>get a string representation of the error status of the network </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>a string representation of the error status of the network </dd></dl>

<p>Implements <a class="el" href="classCitizens_1_1Network.html">Citizens::Network</a>.</p>

</div>
</div>
<a class="anchor" id="a3d94f769e00195248ca6ce2f81c5a745"></a><!-- doxytag: member="Citizens::SFMLNetwork::is_disconnected" ref="a3d94f769e00195248ca6ce2f81c5a745" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SFMLNetwork::is_disconnected </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>returns whether the network has been disconnected </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>a boolean indicating whether or not the network is disconnected </dd></dl>

<p>Implements <a class="el" href="classCitizens_1_1Network.html">Citizens::Network</a>.</p>

</div>
</div>
<a class="anchor" id="a5a8d34814bdbe0517090b95dc8b59eab"></a><!-- doxytag: member="Citizens::SFMLNetwork::login" ref="a5a8d34814bdbe0517090b95dc8b59eab" args="(const std::string &amp;username, const std::string &amp;password)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SFMLNetwork::login </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This function is in charge of a lot, so I'm going to do my best to document it but forgive me if I don't catch everything. </p>
<p>First, the client sends a "LOGIN" packet with the username in it. Next, the server replies with a "LOGIN" packet that contains a single byte of random data Next, the client is expected to encrypt the packet using a hash of the password (salted with the username - note that we may change the salt later if security becomes a problem) The resultant 16 bytes of encrypted data is sent back to the server in an AUTHR packet The server then compares the encrypted data with its own version of the same procedure, using a hash stored in the database as the encryption key The server will then respond with an AUTHR packet that has the payload "GOOD" or "BAD!" to indicate success or failure. There is no way for the client to tell whether it is the username or password which is wrong, so don't even try to program in that security hole </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">username</td><td>pretty obvious really, preserves constness </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">password</td><td>also obvious, also preserves constness </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a boolean indicating whether the login attempt was successful or not </dd></dl>

<p>Implements <a class="el" href="classCitizens_1_1Network.html">Citizens::Network</a>.</p>

</div>
</div>
<a class="anchor" id="a9ca766cae4efc1fccf5cd7e284fdcecc"></a><!-- doxytag: member="Citizens::SFMLNetwork::receive" ref="a9ca766cae4efc1fccf5cd7e284fdcecc" args="(Packet &amp;packet)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SFMLNetwork::receive </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCitizens_1_1Packet.html">Packet</a> &amp;&#160;</td>
          <td class="paramname"><em>packet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>fetch a packet from the network (a lot more complex than that) </p>
<p>expects the passed-in <a class="el" href="structCitizens_1_1Packet.html">Packet</a> to have enough space allocated for the payload*. If not enough space is allocated, a buffer overrun is possible This is a known bug, which will be fixed in a later version. </p>
<dl class="warning"><dt><b>Warning:</b></dt><dd>buffer overrun </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">packet</td><td>that is completely overwritten by the function (all fields are modified) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af3684158823c3e77eb5893f83359dc61"></a><!-- doxytag: member="Citizens::SFMLNetwork::send" ref="af3684158823c3e77eb5893f83359dc61" args="(NetworkCommand c, char payload_length, const std::string &amp;payload)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SFMLNetwork::send </td>
          <td>(</td>
          <td class="paramtype">NetworkCommand&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>payload_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>abstraction for sending a packet across the network </p>
<p>sends a packet across the network, obviously. Note that in future versions the parameter list may be switched for a single <a class="el" href="structCitizens_1_1Packet.html">Packet</a>&amp; parameter </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>the NetworkCommand for the packet </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">payload_length</td><td>the length of the payload of the packet (expected to be correct) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">msg</td><td>a std::string containin the payload (far from the best way of doing it, I know) </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a bool indicating whether the packet was successfully sent or not note that the return status does not mean to imply whether or not the packet was received or not, only whether it was sent. </dd></dl>

<p>Implements <a class="el" href="classCitizens_1_1Network.html">Citizens::Network</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/<a class="el" href="SFMLNetwork_8hpp_source.html">SFMLNetwork.hpp</a></li>
<li>src/SFMLNetwork.cpp</li>
</ul>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 4 2012 22:10:04 for Citizensclient by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
